(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[593],{5215:function(e,t,n){Promise.resolve().then(n.bind(n,314))},314:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return r}});var l=n(7437),a=n(2265),s=n(1169),r=function(e){let{params:t}=e,[n,r]=(0,a.useState)(),i=(0,s.useSearchParams)().get("schedule");return(0,a.useEffect)(()=>{(async()=>{try{let e=await fetch("http://localhost:3000/api/inventory/".concat(t.id,"?schedule=").concat(i));e.ok||console.error(e.statusText);let n=await e.json();0===n.maintenance_record.length&&n.maintenance_record.push({schedule:i,status:"Normal",note:"",ref:""}),r(n)}catch(e){console.error(e)}})()},[]),(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"py-10 lg:py-14 px-5",children:[(0,l.jsx)("h1",{children:"Maintenance Page"}),(0,l.jsx)("div",{className:"grid min-h-dvh gap-2",children:function(e,t){let[n,r]=(0,a.useState)(),[i,d]=(0,a.useState)(),[o,c]=(0,a.useState)(!1),u=async e=>{if((null==e?void 0:e.maintenance_record[0].id)!==void 0){c(!0);return}c(!1),(null==e?void 0:e.maintenance_record[0].status)==="Normal"?r("Normal"):(null==e?void 0:e.maintenance_record[0].status)==="Out of order"?r("Out of order"):r("Other")};async function h(t){let n;t.preventDefault();let l=Object.fromEntries(new FormData(t.target));if(n=o?{id:null==e?void 0:e.maintenance_record[0].id,schedule:l.schedule,inventory_id:null==e?void 0:e.id,status:l.status,note:l.note,ref:l.ref}:{schedule:l.schedule,inventory_id:null==e?void 0:e.id,status:l.status,note:l.note,ref:l.ref},o)await fetch("http://localhost:3000/api/maintenance",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then(e=>{alert("Success"),(0,s.redirect)("/maintenance")});else{await fetch("http://localhost:3000/api/maintenance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then(e=>{alert("Success")}).finally(()=>{window.location.href="/maintenance"});return}}let m=async e=>{e.preventDefault();let t={id:null==i?void 0:i.maintenance_record[0].id};await fetch("http://localhost:3000/api/maintenance",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(e=>{console.log(e),alert("Success")})};return(0,a.useEffect)(()=>{console.log(e),d(e),u(i)},[e,o]),(0,l.jsxs)("form",{className:"flex flex-col gap-4 p-4",onSubmit:h,onReset:m,children:[(0,l.jsxs)("h1",{className:"text-2xl font-semibold",children:["Maintenance Item ",null==i?void 0:i.inventory_id]}),(0,l.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block",htmlFor:"id",children:"ID"}),(0,l.jsx)("input",{className:"w-full  text-gray-700 border rounded-md bg-gray-50",type:"text",name:"id",id:"id",value:(null==i?void 0:i.TIJ_ID)||"",readOnly:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block",htmlFor:"item",children:"Item"}),(0,l.jsx)("input",{className:"w-full  text-gray-700 border rounded-md bg-gray-50",type:"text",name:"item",id:"item",value:(null==i?void 0:i.name)||"",readOnly:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block",htmlFor:"schedule",children:"Schedule"}),(0,l.jsx)("input",{className:"w-full text-gray-700 border rounded-md bg-gray-50",type:"text",name:"schedule",id:"schedule",defaultValue:(null==i?void 0:i.maintenance_record[0].schedule)||"",readOnly:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block",htmlFor:"status",children:"Status"}),(0,l.jsxs)("select",{className:"w-full",name:"status",id:"status",defaultValue:n||"",onChange:e=>r(e.target.value),children:[(0,l.jsx)("option",{value:"Normal",children:"Normal"}),(0,l.jsx)("option",{value:"Out of order",children:"Out out order"}),(0,l.jsx)("option",{value:"Other",children:"Other"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block",htmlFor:"note",children:"Note"}),(0,l.jsx)("input",{className:"w-full border rounded-md",type:"text",name:"note",id:"note",defaultValue:(null==i?void 0:i.maintenance_record[0].note)||""})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block",htmlFor:"ref",children:"Ref"}),(0,l.jsx)("input",{className:"w-full border rounded-md",type:"text",name:"ref",id:"ref",defaultValue:(null==i?void 0:i.maintenance_record[0].ref)||""})]}),(0,l.jsx)("button",{className:"bg-blue-500 text-white rounded-md py-2",type:"submit",children:"Submit"}),o?(0,l.jsx)("button",{className:"bg-red-500 text-white rounded-md py-2",type:"reset",children:"Delete"}):void 0]})]})}(n,0)})]})})}}},function(e){e.O(0,[971,23,744],function(){return e(e.s=5215)}),_N_E=e.O()}]);